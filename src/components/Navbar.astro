---
// Updated mobile navigation - Oct 30, 2025
import { Icon } from 'astro-icon/components';
import { getLangFromUrl, useTranslations, getAlternateLanguage } from '~/utils/i18n';
import MobileNavigation from '~/components/MobileNavigation.astro';

interface Props {
  currentPath?: string;
}

const { currentPath = '/' } = Astro.props;
const url = new URL(Astro.request.url);
const currentLang = getLangFromUrl(url);
const t = useTranslations(currentLang);
const alternateLang = getAlternateLanguage(currentLang);

// Language switcher shows TARGET language (not current)
const targetLangDisplay = alternateLang === 'ar' 
  ? { flag: 'ðŸ‡ªðŸ‡¬', text: 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©', code: 'AR' }
  : { flag: 'ðŸ‡¬ðŸ‡§', text: 'English', code: 'EN' };

// Generate alternate URL
const alternateUrl = alternateLang === 'en' 
  ? currentPath.replace('/ar', '') || '/'
  : '/ar' + currentPath;
---

<nav class="fixed top-0 left-0 w-full z-50 bg-charcoal shadow-premium-sm border-b border-gray-light/20">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex justify-between items-center h-16">
      
      <!-- Logo Section -->
      <div class="flex items-center">
        <a href="/" class="flex items-center">
          <img 
            src="/profit-horizintal.svg" 
            alt="Profit Management Logo" 
            class="h-8 w-auto"
          />
        </a>
      </div>

      <!-- Desktop Navigation -->
      <div class="hidden md:flex items-center justify-center flex-1">
        <ul class="flex items-center space-x-8 font-medium text-white">
          <!-- Home -->
          <li>
            <a 
              href={currentLang === 'ar' ? '/ar' : '/'} 
              class={`hover:text-gold transition-all duration-300 px-3 py-2 rounded-lg whitespace-nowrap font-medium ${
                currentPath === '/' || currentPath === '/ar' ? 'text-gold font-semibold' : 'text-white'
              }`}
            >
              {t('nav.home')}
            </a>
          </li>

          <!-- About -->
          <li>
            <a 
              href={currentLang === 'ar' ? '/ar/about' : '/about'} 
              class={`hover:text-gold transition-all duration-300 px-3 py-2 rounded-lg whitespace-nowrap font-medium ${
                currentPath === '/about' || currentPath === '/ar/about' ? 'text-gold font-semibold' : 'text-white'
              }`}
            >
              {t('nav.about')}
            </a>
          </li>

          <!-- Services -->
          <li>
            <a 
              href={currentLang === 'ar' ? '/ar/services' : '/services'} 
              class={`hover:text-gold transition-all duration-300 px-3 py-2 rounded-lg whitespace-nowrap font-medium ${
                currentPath === '/services' || currentPath === '/ar/services' ? 'text-gold font-semibold' : 'text-white'
              }`}
            >
              {t('nav.services')}
            </a>
          </li>

          <!-- Industries -->
          <li>
            <a 
              href={currentLang === 'ar' ? '/ar/industries' : '/industries'} 
              class={`hover:text-gold transition-all duration-300 px-3 py-2 rounded-lg whitespace-nowrap font-medium ${
                currentPath === '/industries' || currentPath === '/ar/industries' ? 'text-gold font-semibold' : 'text-white'
              }`}
            >
              {t('nav.industries')}
            </a>
          </li>

          <!-- Why Choose Us -->
          <li>
            <a 
              href={currentLang === 'ar' ? '/ar/why' : '/why'} 
              class={`hover:text-gold transition-all duration-300 px-3 py-2 rounded-lg whitespace-nowrap font-medium ${
                currentPath === '/why' || currentPath === '/ar/why' ? 'text-gold font-semibold' : 'text-white'
              }`}
            >
              {t('nav.why')}
            </a>
          </li>

          <!-- Contact -->
          <li>
            <a 
              href={currentLang === 'ar' ? '/ar/contact' : '/contact'} 
              class={`hover:text-gold transition-all duration-300 px-3 py-2 rounded-lg whitespace-nowrap font-medium ${
                currentPath === '/contact' || currentPath === '/ar/contact' ? 'text-gold font-semibold' : 'text-white'
              }`}
            >
              {t('nav.contact')}
            </a>
          </li>
        </ul>
      </div>

      <!-- Language Toggle -->
      <div class="hidden md:flex">
        <a 
          href={alternateUrl}
          class="flex items-center space-x-2 px-3 py-2 rounded-lg text-white hover:text-gold hover:bg-white/10 transition-all duration-300"
          title={`Switch to ${targetLangDisplay.text}`}
        >
          <span class="text-base">{targetLangDisplay.flag}</span>
          <span class="font-medium text-sm">{targetLangDisplay.code}</span>
        </a>
      </div>

      <!-- Mobile Menu Button -->
      <div class="md:hidden">
        <button 
          data-collapse-toggle="mobile-menu" 
          type="button" 
          class="inline-flex items-center p-2 w-10 h-10 justify-center text-white rounded-lg hover:bg-white/10 hover:text-gold transition-all duration-300"
          aria-controls="mobile-menu" 
          aria-expanded="false"
          id="mobile-menu-button"
        >
          <span class="sr-only">Open main menu</span>
          <div class="w-5 h-5 flex flex-col justify-center items-center">
            <span class="hamburger-line block h-0.5 w-5 bg-current transition-all duration-300 ease-out"></span>
            <span class="hamburger-line block h-0.5 w-5 bg-current transition-all duration-300 ease-out mt-1"></span>
            <span class="hamburger-line block h-0.5 w-5 bg-current transition-all duration-300 ease-out mt-1"></span>
          </div>
        </button>
      </div>
    </div>

  </div>
</nav>

<!-- Mobile Navigation Component -->
<MobileNavigation currentPath={currentPath} />

<style>
  /* Premium navbar styling */
  nav {
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
  }


  /* Smooth transitions for all interactive elements */
  nav a,
  nav button {
    transition: all 0.2s ease-in-out;
  }

  /* Remove old active link styling - using dynamic classes instead */


  /* Hover effects for desktop links */
  @media (min-width: 768px) {
    nav ul li a:hover {
      transform: translateY(-1px);
    }
  }

  /* Hamburger menu animation */
  .hamburger-active .hamburger-line:nth-child(1) {
    transform: rotate(45deg) translate(3px, 3px);
  }

  .hamburger-active .hamburger-line:nth-child(2) {
    opacity: 0;
    transform: scale(0);
  }

  .hamburger-active .hamburger-line:nth-child(3) {
    transform: rotate(-45deg) translate(4px, -4px);
  }

</style>

