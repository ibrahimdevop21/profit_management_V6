---
import { getLangFromUrl, useTranslations } from '~/utils/i18n';

interface Partner {
  name: string;
  logo: string;
  alt: string;
}

interface Props {
  title?: string;
  subtitle?: string;
  tagline?: string;
  partners?: Partner[];
  classes?: {
    container?: string;
    title?: string;
    subtitle?: string;
    tagline?: string;
  };
}

const url = new URL(Astro.request.url);
const currentLang = getLangFromUrl(url);
const t = useTranslations(currentLang);

const {
  title = t('partners.title'),
  subtitle = t('partners.subtitle'),
  tagline = t('partners.tagline'),
  partners = [
    {
      name: 'Biomed',
      logo: '/images/partners/biomed.png',
      alt: 'Biomed - Healthcare Solutions'
    },
    {
      name: 'El Agamy',
      logo: '/images/partners/elagamy-removebg-preview.png',
      alt: 'El Agamy - Business Solutions'
    },
    {
      name: 'Riva Pharma',
      logo: '/images/partners/riva_phrma.png',
      alt: 'Riva Pharma - Pharmaceutical Solutions'
    },
    {
      name: 'Hima',
      logo: '/images/partners/hima.png',
      alt: 'Hima - Business Partner'
    },
    {
      name: 'Supakoto',
      logo: '/images/partners/supakoto.png',
      alt: 'Supakoto - Industrial Solutions'
    },
    {
      name: 'Bona',
      logo: '/images/partners/bona.png',
      alt: 'Bona - Business Partner'
    }
  ],
  classes = {}
} = Astro.props;
---

<section class={`py-16 md:py-20 bg-gray-50 ${classes.container || ''}`}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    
    <!-- Section Header -->
    <div class="text-center mb-12 md:mb-16">
      {tagline && (
        <p class={`text-sm font-semibold uppercase tracking-wide text-gold mb-4 text-center ${classes.tagline || ''}`} style="text-align: center !important;">
          {tagline}
        </p>
      )}
      
      {title && (
        <h2 class={`text-3xl md:text-4xl font-bold text-charcoal font-heading mb-4 text-center ${classes.title || ''}`} style="text-align: center !important;">
          {title}
        </h2>
      )}
      
      {subtitle && (
        <p class={`text-lg text-gray-600 max-w-3xl mx-auto leading-relaxed text-center ${classes.subtitle || ''}`} style="text-align: center !important;">
          {subtitle}
        </p>
      )}
    </div>

    <!-- Partners Grid -->
    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-8 md:gap-12 items-center">
      {partners.map((partner, index) => (
        <div 
          class="flex items-center justify-center p-6 bg-white rounded-xl shadow-sm hover:shadow-lg transition-all duration-300 group border border-gray-100"
          style={`animation-delay: ${index * 0.1}s`}
        >
          <img
            src={partner.logo}
            alt={partner.alt}
            class="max-h-12 md:max-h-16 w-auto object-contain transition-all duration-300 group-hover:scale-105"
            loading="lazy"
          />
        </div>
      ))}
    </div>

    <!-- Trust Statement -->
    <div class="text-center mt-12 md:mt-16">
      <p class="text-gray-600 font-medium">
        {t('partners.trustStatement')}
      </p>
    </div>
  </div>
</section>

<style>
  /* Fade in animation for partner logos */
  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .grid > div {
    animation: fadeInUp 0.6s ease-out forwards;
    opacity: 0;
  }

  /* Hover effects */
  .group:hover {
    transform: translateY(-2px);
  }

  /* Ensure logos are always visible with proper contrast */
  .group img {
    opacity: 1 !important;
    visibility: visible !important;
    display: block !important;
    filter: none !important;
    background: transparent !important;
    max-width: 100% !important;
    height: auto !important;
    object-fit: contain !important;
    z-index: 10 !important;
    position: relative !important;
  }

  /* Force visibility for specific logos that might have issues */
  img[src*="misr.png"],
  img[src*="bona.png"],
  img[src*="egyholland-removebg-preview.png"] {
    opacity: 1 !important;
    display: block !important;
    visibility: visible !important;
    background-color: white !important;
    border: 1px solid #e5e7eb !important;
    padding: 8px !important;
    border-radius: 8px !important;
    max-height: 48px !important;
    width: auto !important;
    object-fit: contain !important;
  }

  /* Specific fix for Misr logo container */
  .group:has(img[src*="misr.png"]) {
    background: white !important;
    border: 2px solid #e5e7eb !important;
    min-height: 80px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
  }

  /* Specific fix for Egy Holland logo container */
  .group:has(img[src*="egyholland-removebg-preview.png"]) {
    background: white !important;
    border: 2px solid #e5e7eb !important;
    min-height: 80px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
  }

  /* Responsive adjustments */
  @media (max-width: 768px) {
    .grid {
      gap: 1.5rem;
    }
    
    .grid > div {
      padding: 0.75rem;
    }
  }
</style>
