---
import PageLayout from './PageLayout.astro';
import { getLangFromUrl } from '~/utils/i18n';

export interface Props {
  metadata?: any;
}

const { metadata } = Astro.props;
const currentLang = getLangFromUrl(Astro.url);
const isRTL = currentLang === 'ar';
---

<PageLayout metadata={metadata}>
  <div dir={isRTL ? 'rtl' : 'ltr'} lang={currentLang} class={isRTL ? 'rtl-layout' : 'ltr-layout'}>
    <slot />
  </div>
</PageLayout>

<style>
  /* RTL Layout Styles */
  .rtl-layout {
    direction: rtl;
    text-align: right;
  }

  .rtl-layout .flex {
    flex-direction: row-reverse;
  }

  /* Text alignment for RTL layout */
  .rtl-layout .text-left {
    text-align: right !important;
  }

  .rtl-layout .text-right {
    text-align: left !important;
  }

  .rtl-layout .text-center {
    text-align: center !important;
  }

  /* Ensure all headings are centered in Arabic pages - High specificity */
  .rtl-layout h1,
  .rtl-layout h2,
  .rtl-layout h3,
  .rtl-layout .font-heading,
  .rtl-layout .text-4xl,
  .rtl-layout .text-5xl,
  .rtl-layout .text-6xl,
  .rtl-layout .text-7xl {
    text-align: center !important;
  }

  /* Override text alignment for headings only */
  .rtl-layout h1.text-left,
  .rtl-layout h1.text-right,
  .rtl-layout h2.text-left,
  .rtl-layout h2.text-right,
  .rtl-layout h3.text-left,
  .rtl-layout h3.text-right {
    text-align: center !important;
  }

  /* Specific override for heading elements with Tailwind classes */
  .rtl-layout h1.font-heading,
  .rtl-layout h2.font-heading,
  .rtl-layout h3.font-heading {
    text-align: center !important;
  }

  /* Exception: Keep accordion headers and form labels right-aligned for readability */
  .rtl-layout .accordion-header,
  .rtl-layout label,
  .rtl-layout .text-content {
    text-align: right !important;
  }

  /* Ultimate fallback - force all headings to center with maximum specificity */
  .rtl-layout h1[class*="font-heading"],
  .rtl-layout h2[class*="font-heading"],
  .rtl-layout h3[class*="font-heading"],
  .rtl-layout h1[class*="text-"],
  .rtl-layout h2[class*="text-"],
  .rtl-layout h3[class*="text-"] {
    text-align: center !important;
  }

  .rtl-layout .ml-auto {
    margin-left: 0;
    margin-right: auto;
  }

  .rtl-layout .mr-auto {
    margin-right: 0;
    margin-left: auto;
  }

  /* Arabic font support */
  .rtl-layout {
    font-family: 'Inter', 'Noto Sans Arabic', 'Arial', sans-serif;
  }

  .rtl-layout h1, 
  .rtl-layout h2, 
  .rtl-layout h3, 
  .rtl-layout h4, 
  .rtl-layout h5, 
  .rtl-layout h6 {
    font-family: 'Inter', 'Noto Sans Arabic', 'Arial', sans-serif;
    font-weight: 600;
  }

  /* Adjust spacing for Arabic text */
  .rtl-layout p {
    line-height: 1.8;
  }

  .rtl-layout .nav-link {
    padding-left: 0.75rem;
    padding-right: 0.75rem;
  }

  /* RTL Navbar adjustments */
  .rtl-layout nav .flex {
    flex-direction: row-reverse;
  }

  .rtl-layout nav .space-x-8 > * + * {
    margin-left: 0;
    margin-right: 2rem;
  }

  .rtl-layout nav .space-x-2 > * + * {
    margin-left: 0;
    margin-right: 0.5rem;
  }

  .rtl-layout nav .space-x-3 > * + * {
    margin-left: 0;
    margin-right: 0.75rem;
  }
</style>
